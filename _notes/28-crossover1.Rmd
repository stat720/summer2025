# Crossover Designs I 
July 21st, 2025  

## Announcements

- Project due on Wednesday to send for peer review. 

## Crossover designs  

- Apply treatments to the same experimental unit sequentially, to eliminate between-experimental unit variation when comparing treatments 
- $t$ treatments are compared where each treatment is observed on each of the experimental units (i.e., the treatments are applied in a specified sequence to the experimental units). 
- Mostly applied in animal studies. 
- More in Chapter 29 in the Messy Data book. 

- In non-crossover designs: $y_{ik} = \mu + T_i+ \varepsilon_{ik}$, where $y_{ijk}$ is the observation for the $i$th treatment and the $k$th individual, $T_i$ is the effect of the $i$th treatment, and $\varepsilon_{ij}$ is the residual that includes the variability between individuals (i.e., experimental units). 
- In crossover designs, $y_{ijkl} = \mu + T_i + P_j + u_k + \varepsilon_{ijkl}$,where $y_{ijk}$ is the observation for the $i$th treatment, $j$th period for the $k$th individual that recieved the treatments in the $l$th sequence, $T_i$ is the effect of the $i$th treatment, $P_j$ is the effect of the $j$th period, $u_k$ is the (random) effect of the $k$th individual under the $l$th sequence, and $\varepsilon_{ijkl}$ is the residual. 


```{r echo=FALSE, fig.cap="Schematic representation of a crossover design", out.width = '100%'}
knitr::include_graphics("../figures/crossover.jpg")
```

**Example study the effect of $k$ treatments on response $y$:**

This study was published in Grizzle (1965). 
In this study, the application of treatments was performed in two periods. 
First, 28 persons were randomly applied 1 of 2 treatments, and the trait of study was measured at the end of the treatment duration. 
Then, all persons were applied the other treatment. 

```{r warning=FALSE, message=FALSE}
library(lme4)
library(tidyverse)
```


```{r}
df <- read.csv("../data/grizzle_messydata.csv")
df$Period <- as.factor(df$Period)
df$Person <- as.factor(df$Person)

m <- lmer(Y ~ Trt + Period + (1|Seq:Person) , data = df)

summary(m)
```

## Variations to this example 

- More than 2 periods 
- More than 2 treatments 
- carryover / no carryover




