[["more-multilevel-designs.html", "Day 25 More multilevel designs 25.1 Announcements 25.2 Review: statistical models 25.3 Multi-location trials 25.4 Subsampling", " Day 25 More multilevel designs July 15th, 2025 25.1 Announcements HW 4 due Friday 25.2 Review: statistical models \\[y = \\text{Treatment sources of variability} + \\text{Design sources of variability} + \\varepsilon\\] 25.3 Multi-location trials Nature of multi-location trials Objectives of a multi-location trial How many years? Exercise: find the experimental unit and the groups that are not independent. 25.3.1 Example Multi-environment trial of 64 corn hybrids in six counties in North Carolina. Each location had 3 replicates in in incomplete-block design. library(tidyverse) library(agridat) library(lme4) library(emmeans) df_multienv &lt;- agridat::besag.met df_multienv %&gt;% ggplot(aes(col, row))+ geom_tile(aes(fill = block))+ facet_wrap(~county) m_multienv &lt;- lmer(yield ~ gen + (1|county/block), data = df_multienv) VarCorr(m_multienv) ## Groups Name Std.Dev. ## block:county (Intercept) 3.9453 ## county (Intercept) 36.2722 ## Residual 18.2529 df_multienv %&gt;% group_by(county) %&gt;% summarise(n_distinct(gen)) ## # A tibble: 6 × 2 ## county `n_distinct(gen)` ## &lt;fct&gt; &lt;int&gt; ## 1 C1 64 ## 2 C2 64 ## 3 C3 64 ## 4 C4 64 ## 5 C5 64 ## 6 C6 64 Table 25.1: Sources of Variability for the Multi-environment trial Source df Location l - 1 = 5 Block (Location) (b-1) * l = 7*6 = 42 Genotype g-1 = 63 Error 1078 Total N-1 = 1187 25.3.1.1 Marginal means emmeans(m_multienv, ~ gen)[1:10] ## gen emmean SE df lower.CL upper.CL ## G01 111.2 15.5 5.93 73.2 149 ## G02 107.4 15.5 5.93 69.4 145 ## G03 99.1 15.5 5.93 61.1 137 ## G04 115.1 15.5 5.93 77.1 153 ## G05 120.3 15.5 5.93 82.3 158 ## G06 107.4 15.5 5.93 69.5 145 ## G07 106.7 15.5 5.93 68.7 145 ## G08 113.7 15.5 5.93 75.7 152 ## G09 110.1 15.4 5.88 72.1 148 ## G10 95.4 15.4 5.88 57.4 133 ## ## Degrees-of-freedom method: kenward-roger ## Confidence level used: 0.95 emmeans(m_multienv, ~ gen, contr = list(c(1, -1, rep(0, n_distinct(df_multienv$gen)-2))))$contr ## contrast estimate SE ## c(1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3.81 6.35 ## df t.ratio p.value ## 1029 0.601 0.5479 ## ## Degrees-of-freedom method: kenward-roger 25.4 Subsampling Review: split-plots Split-plot designs are multi-level designed experiments. Randomization happens in different levels. Split-plot designs can happen in blocked designs or in CRDs. Importance of accounting for the subsampling (df and variance) 25.4.1 Example A split-plot experiment in three blocks. Whole-plot is ’management’, sub-plot is ’time’ of application, with two subsamples. The data are the heights, measured on two single-hill sampling units in each plot. df_subsample &lt;- gomez.splitplot.subsample str(df_subsample) ## &#39;data.frame&#39;: 192 obs. of 5 variables: ## $ time : Factor w/ 4 levels &quot;T1&quot;,&quot;T2&quot;,&quot;T3&quot;,..: 1 1 1 1 1 1 1 1 2 2 ... ## $ manage: Factor w/ 8 levels &quot;M1&quot;,&quot;M2&quot;,&quot;M3&quot;,..: 1 2 3 4 5 6 7 8 1 2 ... ## $ rep : Factor w/ 3 levels &quot;R1&quot;,&quot;R2&quot;,&quot;R3&quot;: 1 1 1 1 1 1 1 1 1 1 ... ## $ sample: Factor w/ 2 levels &quot;S1&quot;,&quot;S2&quot;: 1 1 1 1 1 1 1 1 1 1 ... ## $ height: num 104.5 92.3 96.8 94.7 105.7 ... m_subsample &lt;- lmer(height ~ manage * time + (1|rep/manage/time), data = df_subsample) VarCorr(m_subsample) ## Groups Name Std.Dev. ## time:manage:rep (Intercept) 4.0433 ## manage:rep (Intercept) 2.7422 ## rep (Intercept) 4.3692 ## Residual 1.3205 Table 25.2: Sources of Variability for the Multi-environment trial Source df Location l - 1 = 5 Block (Location) (b-1) * l = 7*6 = 42 Genotype g-1 = 63 Error 1078 Total N-1 = 1187 emmeans(m_subsample, ~manage, contr = list(c(1, -1, 0, 0, 0, 0, 0, 0)))$contr ## NOTE: Results may be misleading due to involvement in interactions ## contrast estimate SE df t.ratio p.value ## c(1, -1, 0, 0, 0, 0, 0, 0) 5.85 2.81 14 2.085 0.0559 ## ## Results are averaged over the levels of: time ## Degrees-of-freedom method: kenward-roger emmeans(m_subsample, ~time, contr = list(c(1, -1, 0, 0)))$contr ## NOTE: Results may be misleading due to involvement in interactions ## contrast estimate SE df t.ratio p.value ## c(1, -1, 0, 0) -2.68 1.2 48 -2.238 0.0299 ## ## Results are averaged over the levels of: manage ## Degrees-of-freedom method: kenward-roger "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
