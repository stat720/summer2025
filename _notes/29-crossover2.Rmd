# Crossover Designs II 
July 22nd, 2025  

## Announcements

- Project due on Wednesday to send for peer review. 
- The Difference Between “Significant” and “Not Significant” is not Itself Statistically Significant - [Gelman and Stern (2012)](https://www.tandfonline.com/doi/abs/10.1198/000313006X152649)
- **Homework due tomorrow, 7am:** write a question in this Google Docs, or answer a question someone made. Make sure you have your track changes on, or leave your last name in a comment.  


## Crossover designs  

- Apply treatments to the same experimental unit sequentially, to eliminate between-experimental unit variation when comparing treatments 
- $t$ treatments are compared where each treatment is observed on each of the experimental units (i.e., the treatments are applied in a specified sequence to the experimental units). 
- Mostly applied in animal studies. 
- In non-crossover designs: $y_{ik} = \mu + T_i+ \varepsilon_{ik}$, where $y_{ijk}$ is the observation for the $i$th treatment and the $k$th individual, $T_i$ is the effect of the $i$th treatment, and $\varepsilon_{ij}$ is the residual that includes the variability between individuals (i.e., experimental units). 
- In crossover designs, $y_{ijkl} = \mu + T_i + P_j + S_k + u_l + \varepsilon_{ijkl}$,where $y_{ijk}$ is the observation for the $i$th treatment, $j$th period for the $l$th individual that received the treatments in the $k$th sequence, $T_i$ is the effect of the $i$th treatment, $P_j$ is the effect of the $j$th period, $S_k$ is the effect of the $k$th sequence, $u_l$ is the (random) effect of the $l$th individual under the $k$th sequence, and $\varepsilon_{ijkl}$ is the residual. 
- More in Chapter 29 in the Messy Data book. 

**Pros:**

- Fewer EUs (probably living beings) required 
- Power (?) 
- Between-EU variability is accounted for in the model  

**Cons:** 

- Carryover (residual) effects  
- Power (!?) 
- Longer duration of the experiment 

Overall model:  

$$y_{ijklm} = \mu + T_i + P_j + S_k +PT_{l} + u_m + \varepsilon_{ijklm}, \\
u{m} \sim N(0, \sigma^2_u), \\
\varepsilon_{ijklm} \sim N(0, \sigma^2_\varepsilon),$$
where:

-  $y_{ijk}$ is the observation for the $i$th treatment, $j$th period with the $m$th previous treatment and the $m$th individual that received the treatments in the $k$th sequence, 
- $T_i$ is the effect of the $i$th treatment, 
- $P_j$ is the effect of the $j$th period, 
- $S_k$ is the effect of the $k$th sequence, 
- $PT_{l}$ is the carryover effect of the $l$th treatment,   
- $u_{mk}$ is the (random) effect of the $m$th individual under the $k$th sequence, 
and $\varepsilon_{ijkl}$ is the residual. 


```{r echo=FALSE, fig.cap="Schematic representation of a crossover design", out.width = '100%'}
knitr::include_graphics("../figures/crossover.jpg")
```



## Applied example  

6 cows were used to test 3 different treatments in a crossover design.  

```{r message=FALSE, warning=FALSE}
df <- read.csv("../data/cow_prod_cox.csv")
df
```


```{r message=FALSE, warning=FALSE}
library(lme4)
library(emmeans)
m_milk.nocarryover <- lmer(milk_production ~ Sequence + Period + Treatment + (1|Sequence:Cow),
               data = df)
emmeans(m_milk.nocarryover, ~ Treatment )

```
```{r}
m_milk.carryover <- lmer(milk_production ~ Sequence + Period + Treatment + Prior_trt + (1|Sequence:Cow),
               data = df)

emmeans(m_milk.carryover, ~ Treatment )
```

**Note:** 

- Repeated measures. Now we are assuming compound symmetry (a specific type of correlation function). 
- How does carryover affect power? 

