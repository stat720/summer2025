# Review: Applied split-plot 
July 1st, 2025  

## Background  

Yesterday, we designed an experiment with an RCBD to figure out the best temperature to bake the muffins?  
Check out the original recipe [here](https://www.ouichefnetwork.com/2016/06/a-life-changing-banana-nut-muffin.html).

```{r}

```

**Dry ingredients:**  

- 1 1/2 cups all-purpose flour (7 1/2 ounces)
- 1 1/2 teaspoons baking powder 
- 1/4 teaspoon baking soda 
- 1/2 teaspoon salt 
- 1/4 teaspoon ground cinnamon 
- 1/4 teaspoon ground nutmeg
- 2/3 cup finely chopped pecans, toasted

**Wet ingredients:**  

- 1/2 cup light brown sugar (3 3/4 ounces)
- 1/4 cup granulated sugar (2 ounces)
- 2 large eggs
- 1 stick unsalted butter, browned and cooled (4 ounces)
- 1 1/2 cups mashed bananas, from very ripe bananas that have been peeled and mashed well with a fork (12 3/4 ounces or 361 gr.)
- 2 tablespoons full-fat sour cream
- 1 teaspoon pure vanilla extract 

### Research question

What is the best temperature to bake the muffins? 
- 300 °F
- 400 °F
- 500 °F

How much banana? 
- 1 1/2 cups (12.75 oz, or 361 gr.)
- 2 cups (17 oz, or 482 gr.) 

### Proposed design experiment: RCBD 

- Cooking day as blocks 
- Oven as mini-blocks for banana quantity 

$$y_{ik} = \mu + T_i + b_k + \varepsilon_{ik}$$
$$b_k \sim N(0, \sigma_b^2) \\ \varepsilon_{ik} \sim N(0, \sigma_{\varepsilon}^2)$$

ANOVA table for this split-plot design 

```{r echo=FALSE, message=FALSE, warning=FALSE}
t_splitplot <- data.frame(Source = c("Day (block)", "Temperature", "Wholeplot|Error(oven)|Oven(Day)", 
                                     "Banana", "Temp x Banana", 
                                     "Error | Loaf(Oven x Day)", "Total"),
                    df = c("r-1 = 3-1 = 2", "t-1 = 3-1 = 2", 
                           "(t-1)r - (t-1) = 2*3 - 2 = 4",
                           "b-1 = 2-1 = 1",
                           "(t-1) (b-1) = 2*1 = 2",
                           "(b-1)tr - (b-1) - (t-1) (b-1)= (1 * 3 * 3) - 1 - 2 = 6",
                           "N-1 = 17"))
knitr::kable(t_splitplot, caption = "Treatment ANOVA for a two-way treatment structure in a split-plot")
```

### Treatment means and confidence intervals  

The treatment mean for the $i$th temperature and $j$th banana level is $\mu_{ij} = \mu + T_i + B_j +(TB)_{ij}$. 
That mean won't change under different design structures. 
What *might* change is the confidence interval around that mean.  

- First, recall the formula for a CI: $\theta \pm t_{df, \frac{\alpha}{2}} \cdot se(\hat{\theta})$

- For example, the CI for the differences between means for 300F and 400F $\mu_{1 \cdot} - \mu_{2 \cdot}$ is $(\mu_{1 \cdot} - \mu_{2 \cdot}) \pm 1.96 \cdot se(\widehat{\mu_{1 \cdot} - \mu_{2 \cdot}})$ 
- $se(\widehat{\mu_{1 \cdot} - \mu_{2 \cdot}}) = \sqrt{\frac{2 (\sigma^2_{\varepsilon} + b  \cdot \sigma^2_w)}{b \cdot r}}$

$$\mu_i \pm 1.96 \cdot \sqrt{\frac{2 (\sigma^2_{\varepsilon} + b \cdot \sigma^2_w)}{b \cdot r}}$$

- The CI for the differences between means for normal and high banana $\mu_{\cdot 1} - \mu_{\cdot 2}$ is $(\mu_{\cdot 1} - \mu_{\cdot 2}) \pm 1.96 \cdot se(\widehat{\mu_{\cdot 1} - \mu_{\cdot 2}})$ 
- $se(\widehat{\mu_{\cdot 1} - \mu_{\cdot 2}}) = \sqrt{\frac{2 \sigma^2_{\varepsilon}}{t \cdot r}}$

$$\mu_i \pm 1.96 \cdot \sqrt{\frac{2 \sigma^2_{\varepsilon}}{r}}$$


