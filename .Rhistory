axis.text.x = element_text(angle = 50, vjust = 1, hjust=1))
read.csv("../../students_STAT_720_C.csv") %>%
ggplot(aes(degreeProgram))+
geom_bar(fill = "green")+
theme_bw()+
theme(panel.grid.minor = element_blank(),
panel.border = element_blank()
axis.title.x = element_blank(),
axis.text.x = element_text(angle = 50, vjust = 1, hjust=1))
read.csv("../../students_STAT_720_C.csv") %>%
ggplot(aes(degreeProgram))+
geom_bar(fill = "green")+
theme_bw()+
theme(panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_text(angle = 50, vjust = 1, hjust=1))
library(tidyverse)
read.csv("../../students_STAT_720_C.csv") %>%
ggplot(aes(degreeProgram))+
geom_bar(fill = "#B388EB")+
theme_bw()+
theme(panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_text(angle = 50, vjust = 1, hjust=1))
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
b=3;t=4
(t-1)*b
8+2+3
9-(t-1)+2+3
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(glmmTMB)
library(agridat)
library(tidyverse)
library(glmmTMB)
library(agridat)
data("omer.sorghum")
omer.sorghum
omer.sorghum %>% filter(env == "E1")
df <- omer.sorghum %>% filter(env == "E1")
library(tidyverse)
df
lm(yield ~ gen + rep, data= omer.sorghum)
m <- lm(yield ~ gen + rep, data= omer.sorghum)
car::Anova(m, type =2 )
m <- lm(yield ~ gen + rep, data= df)
n_distinct(df$gen)
n_distinct(df$rep)
car::Anova(m, type =2 )
17*3
17*3+17+3
(17*4)-17
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
data.frame(`Source of variation` = c("Blocks", "Treatment", "Error", "Total"),
df = c("b-1", "t-1", "(u-1)", "N-1")) %>%
knitr::kable(caption = "Title of the table")
data.frame(`Source of variation` = c("Blocks", "Treatment", "Error", "Total"),
df = c("b-1 = 3-1 = 2", "t-1 = 6-1 = 5", "(u-1)*b - (t-1) = (12-1)3 - (t-1)", "N-1 = 36 - 1 = 35")) %>%
knitr::kable(caption = "Title of the table")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
library(xtable)
t1 <- kable(head(mtcars)[1:3], format = "latex", booktabs = TRUE)
t2 <- kable(head(mtcars)[4:6], format = "latex", booktabs = TRUE)
cat(c("\\begin{table}[!htb]
\\begin{minipage}{.5\\linewidth}
\\caption{}
\\centering",
t1,
"\\end{minipage}%
\\begin{minipage}{.5\\linewidth}
\\centering
\\caption{}",
t2,
"\\end{minipage}
\\end{table}"
))
t1 <- kable(head(mtcars)[1:3], format = "latex", booktabs = TRUE)
t2 <- kable(head(mtcars)[4:6], format = "latex", booktabs = TRUE)
library(xtable)
library(knitr)
library(xtable)
library(knitr)
t1 <- kable(head(mtcars)[1:3], format = "latex", booktabs = TRUE)
t2 <- kable(head(mtcars)[4:6], format = "latex", booktabs = TRUE)
cat(c("\\begin{table}[!htb]
\\begin{minipage}{.5\\linewidth}
\\caption{}
\\centering",
t1,
"\\end{minipage}%
\\begin{minipage}{.5\\linewidth}
\\centering
\\caption{}",
t2,
"\\end{minipage}
\\end{table}"
))
knitr::kable(list(t1, t2))
t_topo <- data.frame(`Source of variation` = c("Block", " ", "Pens(Block)", "Total"),
df = c("b-1", "(u-1)*b", "N-1"))
t_topo <- data.frame(`Source of variation` = c("Block", " ", "Pens(Block)", "Total"),
df = c("b-1", " ", "(u-1)*b", "N-1"))
t_trt <- data.frame(`Source of variation` = c(" ", "Treatment", "Error", "Total"),
df = c(" ", "t-1", "N-t", "N-1"))
t_comb <- data.frame(`Source of variation` = c("Block", "Treatment", "Pens(Block x Trt)", "Total"),
df = c("b-1", "t-1", "(u-1)*b - (t-1)", "N-1"))
knitr::kable(list(t_topo, t_trt, t_comb))
t_topo <- data.frame(Source = c("Block", " ", "Pens(Block)", "", "Total"),
df = c("b-1", "-", "(u-1)*b", "-", "N-1"))
t_trt <- data.frame(Source = c(" ", "Treatment", "", "Parallels", "Total"),
df = c("-", "t-1", "-", "N-t", "N-1"))
t_comb <- data.frame(Source = c("Block", "Treatment", "Pens(Block x Trt)", "", "Total"),
df = c("b-1", "t-1", "(u-1)*b - (t-1)", "-", "N-1"))
# knitr::kable(list(t_topo, t_trt, t_comb),
# caption = c("a", "b", "c"))
k1 <- kable(t_topo, caption = "a") %>%
kable_styling(bootstrap_options = c("striped", "condensed"), full_width = FALSE)
k2 <- kable(t_trt, caption = "b") %>%
kable_styling(bootstrap_options = c("striped", "condensed"), full_width = FALSE)
k3 <- kable(t_comb, caption = "c") %>%
kable_styling(bootstrap_options = c("striped", "condensed"), full_width = FALSE)
# Display tables side by side
kableExtra::column_spec(1, width = "33%")
htmltools::tagList(
htmltools::tags$table(
htmltools::tags$tr(
htmltools::tags$td(k1),
htmltools::tags$td(k2),
htmltools::tags$td(k3)
)
)
)
install.packages("kableExtra")
install.packages("kableExtra")
kable(list(k1, k2, k3))
t_topo <- data.frame(Source = c("Block", " ", "Pens(Block)", "", "Total"),
df = c("b-1", "-", "(u-1)*b", "-", "N-1"))
t_trt <- data.frame(Source = c(" ", "Treatment", "", "Parallels", "Total"),
df = c("-", "t-1", "-", "N-t", "N-1"))
t_comb <- data.frame(Source = c("Block", "Treatment", "Pens(Block x Trt)", "", "Total"),
df = c("b-1", "t-1", "(u-1)*b - (t-1)", "-", "N-1"))
# knitr::kable(list(t_topo, t_trt, t_comb),
# caption = c("a", "b", "c"))
k1 <- kable_styling(kable(t_topo, caption = "a"),
bootstrap_options = c("striped", "condensed"), full_width = FALSE)
k2 <- kable_styling(kable(t_trt, caption = "b"),
bootstrap_options = c("striped", "condensed"), full_width = FALSE)
k3 <- kable_styling(kable(t_comb, caption = "c"),
bootstrap_options = c("striped", "condensed"), full_width = FALSE)
kable(list(k1, k2, k3))
t_topo <- data.frame(Source = c("Block", " ", "Pens(Block)", "", "Total"),
df = c("b-1", "-", "(u-1)*b", "-", "N-1"))
t_trt <- data.frame(Source = c(" ", "Treatment", "", "Parallels", "Total"),
df = c("-", "t-1", "-", "N-t", "N-1"))
t_comb <- data.frame(Source = c("Block", "Treatment", "Pens(Block x Trt)", "", "Total"),
df = c("b-1", "t-1", "(u-1)*b - (t-1)", "-", "N-1"))
knitr::kable(list(t_topo, t_trt, t_comb),
caption = c("a", "b", "c"))
t_topo <- data.frame(Source = c("Block", " ", "Pens(Block)", "", "Total"),
df = c("b-1", "-", "(u-1)*b", "-", "N-1"))
t_trt <- data.frame(Source = c(" ", "Treatment", "", "Parallels", "Total"),
df = c("-", "t-1", "-", "N-t", "N-1"))
t_comb <- data.frame(Source = c("Block", "Treatment", "Pens(Block x Trt)", "", "Total"),
df = c("b-1", "t-1", "(u-1)*b - (t-1)", "-", "N-1"))
knitr::kable(list(t_topo, t_trt, t_comb),
caption = c("a | b | c"))
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
knitr::opts_chunk$set(echo = TRUE)
# inspect X
getME(m, "X")
# inspect X
model.matrix(m)
data("omer.sorghum")
df <- omer.sorghum %>% filter(env == "E3")
# find out how many levels for trt factor "genotype"
n_distinct(df$gen)
# find out how many blocks
n_distinct(df$rep)
# fit linear model
m <- lm(yield ~ gen + rep, data= df)
# inspect X
model.matrix(m)
plot(m)
car::qq.plot(m)
car::qqPlot(m)
# check for constant variance
plot(m$fitted.values, m$residuals)
car::leveneTest(m)
m
car::leveneTest(yield ~ gen + rep, data = df)
df
car::leveneTest(yield ~ gen + rep, data = df)
car::leveneTest(yield ~ gen * rep, data = df)
car::leveneTest(yield ~ gen , data = df)
car::leveneTest(yield ~ gen , data = df)
plot(m$fitted.values, abs(m$residuals))
lm(abs(m$residuals) ~ m$fitted.values)
summary(lm(abs(m$residuals) ~ m$fitted.values))
summary(lm(abs(m$residuals) ~ m$fitted.values))
shapiro.test(m$residuals)
df
df2 <- df %>% filter(rep != "R3")
# find out how many levels for trt factor "genotype"
n_distinct(df2$gen)
# find out how many blocks
n_distinct(df2$rep)
# find out how many blocks
n_distinct(df$rep)
df2 <- df %>% filter(rep != "R3")
# find out how many levels for trt factor "genotype"
n_distinct(df2$gen)
# find out how many blocks
n_distinct(df2$rep)
m2 <- lm(yield ~ gen + rep, data= df2)
car::Anova(m2, type = 2)
car::Anova(m, type = 2)
car::Anova(m2, type = 2)
df2 <- df %>% filter(rep %in% c("R1", "R3"))
df2 <- df %>% filter(rep %in% c("R1", "R3"))
# find out how many levels for trt factor "genotype"
n_distinct(df2$gen)
# find out how many blocks
n_distinct(df2$rep)
m2 <- lm(yield ~ gen + rep, data= df2)
car::Anova(m, type = 2)
car::Anova(m2, type = 2)
df2 <- df %>% filter(rep %in% c("R1", "R2"))
# find out how many levels for trt factor "genotype"
n_distinct(df2$gen)
# find out how many blocks
n_distinct(df2$rep)
m2 <- lm(yield ~ gen + rep, data= df2)
car::Anova(m, type = 2)
car::Anova(m2, type = 2)
df2 <- df %>% filter(rep %in% c("R1", "R4"))
# find out how many levels for trt factor "genotype"
n_distinct(df2$gen)
# find out how many blocks
n_distinct(df2$rep)
m2 <- lm(yield ~ gen + rep, data= df2)
car::Anova(m, type = 2)
car::Anova(m2, type = 2)
plot(m2$fitted.values, m2$residuals)
plot(m2$fitted.values, abs(m2$residuals))
car::qqPlot(m2)
car::Anova(m2, type = 2)
car::Anova(m, type = 2)
car::Anova(m2, type = 2)
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
library(tidyverse)
library(glmmTMB)
library(agridat)
# load data
data("omer.sorghum")
df <- omer.sorghum %>% filter(env == "E3")
df
# find out how many levels for trt factor "genotype"
n_distinct(df$gen)
# find out how many blocks
n_distinct(df$rep)
m <- lm(yield ~ gen + rep, data= df)
# inspect X
model.matrix(m)
car::Anova(m, type = 2)
emmeans::emmeans(m, ~gen)
# check for constant variance
plot(m$fitted.values, m$residuals)
plot(m$fitted.values, abs(m$residuals))
# summary(lm(abs(m$residuals) ~ m$fitted.values))
# car::leveneTest(yield ~ gen , data = df)
# check for normality
car::qqPlot(m)
# shapiro.test(m$residuals)
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
library(tidyverse)
library(glmmTMB)
library(agridat)
# load data
data("omer.sorghum")
df <- omer.sorghum %>% filter(env == "E3")
# find out how many levels for trt factor "genotype"
n_distinct(df$gen)
# find out how many blocks
n_distinct(df$rep)
# fit linear model
m <- lm(yield ~ gen + rep, data= df)
# inspect X
model.matrix(m)
# these options will affect the baseline for the estimation of the effects
# options(contrasts = c("contr.sum", "contr.poly"))
# options(contrasts = c("contr.treatment", "contr.poly"))
library(tidyverse)
library(glmmTMB)
library(agridat)
# load data
data("omer.sorghum")
df <- omer.sorghum %>% filter(env == "E3")
# find out how many levels for trt factor "genotype"
n_distinct(df$gen)
# find out how many blocks
n_distinct(df$rep)
# fit linear model
m_without <- lm(yield ~ gen , data= df)
m_with <- lm(yield ~ gen + rep, data= df)
m_without$df.residual
m_with$df.residual
summary(m_without)$sigma
summary(m_with)$sigma
m_without
library(emmeans)
emmeans(m_without, ~ gen)
emmeans(m_with, ~ gen)
emmeans(m_without, ~ gen)
emmeans(m_with, ~ gen)
library(tidyverse)
library(emmeans)
library(agridat)
# load data
data("omer.sorghum")
df <- omer.sorghum %>% filter(env == "E3")
# find out how many levels for trt factor "genotype"
n_distinct(df$gen)
# find out how many blocks
n_distinct(df$rep)
# fit linear model
options(contrasts = c("contr.sum", "contr.poly"))
m_without <- lm(yield ~ gen , data= df)
m_with <- lm(yield ~ gen + rep, data= df)
m_without$df.residual
summary(m_without)$sigma
m_with$df.residual
summary(m_with)$sigma
emmeans(m_without, ~ gen)
emmeans(m_with, ~ gen)
confint(m_without)
confint(m_with)
confint(m_without)
confint(m_with)
confint(m_without)[2,2] - confint(m_without)[1,2]
confint(m_with)[2,2] - confint(m_with)[1,2]
confint(m_without)[2,2] - confint(m_without)[1,2]
confint(m_with)[2,2] - confint(m_with)[1,2]
confint(m_without)[2,2] - confint(m_without)[2, 1]
confint(m_with)[2,2] - confint(m_with)[2,1]
means_with <- emmeans(m_without, ~ gen)
means_without <- emmeans(m_with, ~ gen)
means_with
library(multcomp)
cld(means_with)
cld(means_with, method = "sidak", Letters = letters)
cld(means_with, method = "sidak", Letters = letters)
cld(means_without, method = "sidak", Letters = letters)
cld(means_with, method = "sidak", Letters = letters)
cld(means_without, method = "sidak", Letters = letters)
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
car::Anova(m, type = 2)
anova(lm(yield ~ gen, data = df),lm(yield ~ gen+rep, data = df))
anova(m)
anova(m)
anova(lm(yield ~ gen, data = df),lm(yield ~ gen+rep, data = df))
anova(lm(yield ~ 1, data = df), lm(yield ~ gen, data = df),lm(yield ~ gen+rep, data = df))
anova(m)
anova(lm(yield ~ 1, data = df), lm(yield ~ gen, data = df),lm(yield ~ gen+rep, data = df))
2478067+233806+1306996
m_int <- lm(yield ~ 1, data = df)
m_gen <- lm(yield ~ gen, data = df)
m_gen_bl <- lm(yield ~ gen+rep, data = df)
m_int <- lm(yield ~ 1, data = df)
m_gen <- lm(yield ~ gen, data = df)
m_gen_bl <- lm(yield ~ gen+rep, data = df)
anova(m_int, m_gen, m_gen_bl)
car::Anova(m, type = 2)
emmeans::emmeans(m, ~gen)
anova(m)
m_int <- lm(yield ~ 1, data = df)
m_gen <- lm(yield ~ gen, data = df)
m_gen_bl <- lm(yield ~ gen+rep, data = df)
anova(m_int, m_gen, m_gen_bl)
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(agridat)
data("omer.sorghum")
df <- omer.sorghum %>% filter(env == "E3")
df
n_distinct(df$gen)
n_distinct(df$rep)
df %>%
ggplot(aes(gen, yield))+
geom_point()
lm(yield ~ 1 + gen + rep, data = df)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(agridat)
data("omer.sorghum")
df <- omer.sorghum %>% filter(env == "E3")
n_distinct(df$gen)
n_distinct(df$rep)
df %>%
ggplot(aes(gen, yield))+
geom_point()
lm(yield ~ 1 + gen + rep, data = df)
lm(yield ~ 1 + gen + rep, data = df)
contr.poly(contrasts = c("contr.sum", "contr.poly"))
lm(yield ~ 1 + gen + rep, data = df)
# glmmTMB(yield ~ 1 + gen + rep, data = df,
#         family = gaussian())
lm(yield ~ 1 + gen + rep, data = df)
options(contrasts = c("contr.sum", "contr.poly"))
lm(yield ~ 1 + gen + rep, data = df)
# glmmTMB(yield ~ 1 + gen + rep, data = df,
#         family = gaussian())
lm(yield ~ 1 + gen + rep, data = df)
lm(yield ~ 1 + gen + rep, data = df)
m1 <- lm(yield ~ 1 + gen + rep, data = df)
summary(m1)
summary(m1)
# constant variance
plot(x = m1$fitted.values, y = m1$residuals)
# constant variance
plot(x = m1$fitted.values, y = abs(m1$residuals))
lm(abs(m1$residuals)  ~ m1$fitted.values)
summary(lm(abs(m1$residuals)  ~ m1$fitted.values))
# constant variance
plot(x = m1$fitted.values, y = abs(m1$residuals))
summary(lm(abs(m1$residuals)  ~ m1$fitted.values))
summary(lm(abs(m1$residuals)  ~ m1$fitted.values))
car::qqPlot(m1)
car::Anova(m1, type = 2)
1306996/51
sqrt(1306996/51)
sqrt(1306996/51)
summary(m1)$sigma
m2 <- lm(yield ~ gen , data = df)
car::Anova(m2)
1540802/54
sqrt(1540802/54)
summary(m2)$sigma
sqrt(1540802/54)
summary(m2)$sigma
library(emmeans)
emmeans(m1, ~gen)
emmeans(m1, ~gen)
emmeans(m2, ~gen)
means_1<-emmeans(m1, ~gen)
means_2<-emmeans(m2, ~gen)
library(multcomp)
cld(means_1, method = "sidak", Letters = letters)
cld(means_2, method = "sidak", Letters = letters)
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
plot(m2$fitted.values, abs(m2$residuals))
car::qqPlot(m2)
knitr::opts_chunk$set(echo = TRUE)
library(agridat)
data("omer.sorghum")
omer.sorghum %>% filter(env == "E3")
library(tidyverse)
library(agridat)
data("omer.sorghum")
df <- omer.sorghum %>% filter(env == "E3")
lm(yield ~ 1 + gen + rep, data = df)
bookdown::render_book(input = "C:/Users/lacasa/Documents/teaching/stat720/2025summer/summer2025/_notes", output_dir = "../notes")
browseURL("notes/index.html")
